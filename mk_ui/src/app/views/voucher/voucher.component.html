<div *ngIf="loader" class="spinner">
    <div class="rect1"></div>
    <div class="rect2"></div>
    <div class="rect3"></div>
    <div class="rect4"></div>
    <div class="rect5"></div>
</div>
<section class="format-layout">
    <div id="divList">
        <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-4">
                <h2 class="text-center">Voucher</h2>
            </div>
            <div class="col-md-4 text-right">
                <h2><i class="fa fa-plus-square pointer" (click)="redirectVoucher()"></i></h2>
            </div>
        </div>
        <div class="row ">
            <div class="col-md-6">
                <input class="form-control border" placeholder="Search...">
            </div>
            <div class="col-md-6">
                <input type="text" placeholder="Date" class="form-control border" bsDatepicker>
            </div>
        </div>
        <div class="row bg-secondary text-white">
            <div class="col-md-1">
                <h1>21</h1>
            </div>
            <div class="col-md-9">
                <span>Expense: Ăn tiệm <br /> <i>Description</i></span>
            </div>
            <div class="col-md-2">
                <span>856 VND <br /> <i>Description</i></span>
            </div>
        </div>
        <div class="row list">
            <div class="col-md-1">
                <img src="../../../assets/img/question.png" />
            </div>
            <div class="col-md-9">
                <span>Expense: Ăn tiệm <br /> <i>Description</i></span>
            </div>
            <div class="col-md-2">
                <span>856 VND <br /> <i>Description</i></span>
            </div>
        </div>
    </div>
    <div id="divVoucher">
        <div class="row">
            <div class="col-md-4">
                <h2><i class="fa fa-arrow-left pointer" (click)="redirectList()"></i></h2>
            </div>
            <div class="col-md-4">
                <h2 class="text-center">Add Voucher</h2>
            </div>
            <div class="col-md-4">
            </div>
        </div>
        <form class="voucher" name="form" #f="ngForm" (ngSubmit)="f.form.valid && save()">
            <div class="row">
                <div class="form-group col-md-6">
                    <div class="row">
                        <div class='input-group mb-3'>
                            <div class="col-md-4">
                                <p>Type</p>
                            </div>
                            <div class="col-md-8">
                                <select name="type" #type="ngModel" [(ngModel)]="vm.type" class="form-control" (click)="hideShow(vm.type)">
                            <option value='Expense' selected>Expense</option>
                            <option value='Income'>Income</option>
                            <option value='Transfer'>Transfer</option>
                            <option value='Adjustment'>Adjustment</option>
                        </select>
                            </div>
                        </div>
                    </div>
                    <hr>
                </div>
                <div class="form-group col-md-6">
                    <div class="row">
                        <div class='input-group mb-3'>
                            <input type='number' name="total" id="total" #total="ngModel" [(ngModel)]="vm.total" class='form-control' placeholder='Amount' required>
                            <span class='input-group-text' id='basic-addon2'>VND</span>
                        </div>
                    </div>
                    <hr>
                    <span [hidden]="total.valid || (total.pristine && !f.submitted)" class="k-widget k-tooltip k-tooltip-validation k-invalid-msg field-validation-error">
                <i class="fa fa-exclamation-triangle"></i> Enter your Total!
            </span>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <div class="row">
                        <div class="col-md-4">
                            <p>Category <span class="text-danger">(*)</span></p>
                        </div>
                        <div class="col-md-8" (click)='categoryModal.show()'>
                            <img *ngIf='selectedCategory.icon != ""' width="40px" src="{{apiURL + selectedCategory.icon}}" /> {{ selectedCategory.text }}
                        </div>
                    </div>
                    <hr>
                    <span [hidden]="selectedCategory.code != '' || (selectedCategory.code === '' && !f.submitted)" class="k-widget k-tooltip k-tooltip-validation k-invalid-msg field-validation-error">
                <i class="fa fa-exclamation-triangle"></i> Choose your Categorry!
            </span>
                </div>
                <div class="form-group col-md-6" (click)='accountModal.show()'>
                    <div class="row">
                        <div class="col-md-4">
                            <p>{{ labelAccountId }} <span class="text-danger">(*)</span></p>
                        </div>
                        <div class="col-md-8">{{ selectedAccount.text }}
                            <!-- <select name="accountId" class="form-control" #accountId="ngModel" [(ngModel)]="vm.accountId">
                        <option *ngFor="let i of account" value="{{i.id}}">{{i.text}}</option>
                    </select> -->
                        </div>
                    </div>
                    <hr>
                    <span [hidden]="selectedAccount.accountId != 0 || (selectedAccount.accountId === 0 && !f.submitted)" class="k-widget k-tooltip k-tooltip-validation k-invalid-msg field-validation-error">
                <i class="fa fa-exclamation-triangle"></i> Choose your {{ labelAccountId }}!
            </span>
                </div>
                <div class="form-group col-md-6" *ngIf="isTransfer">
                    <div class="row">
                        <div class='input-group mb-3'>
                            <input type='number' class='form-control' placeholder='Transfer fee'>
                            <span class='input-group-text' id='basic-addon2'>VND</span>
                        </div>
                    </div>
                </div>
                <div class="form-group col-md-6" *ngIf="isTransfer" (click)='toAccountModal.show()'>
                    <div class="row">
                        <div class="col-md-4">
                            <p>To Account <span class="text-danger">(*)</span></p>
                        </div>
                        <div class="col-md-8">{{ selectedToAccount.text }}
                        </div>
                    </div>
                    <hr>
                    <span [hidden]="selectedToAccount.accountId != 0 || (selectedToAccount.accountId === 0 && !f.submitted)" class="k-widget k-tooltip k-tooltip-validation k-invalid-msg field-validation-error">
                <i class="fa fa-exclamation-triangle"></i> Choose your To Account!
            </span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-2">
                    <p>Description</p>
                </div>
                <div class="col-md-10">
                    <input class="form-control none-border" name="description" #description="ngModel" [(ngModel)]="vm.description" />
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-2">
                    <p>Date</p>
                </div>
                <div class="col-md-8">
                    <input type="text" placeholder="Date" class="form-control" bsDatepicker>
                </div>
                <div class="col-md-2">
                    <!-- TODO -->
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="form-group col-md-12" *ngIf="!isTransfer ">
                    <div class="row">
                        <div class="col-md-2">
                            <p>{{ labelObj }}</p>
                        </div>
                        <div class="col-md-10">
                            <input class="form-control none-border" name="Payee" #object="ngModel" [(ngModel)]="vm.object" />
                        </div>
                    </div>
                    <hr>
                </div>
                <!-- <div class="form-group col-md-6" *ngIf="!isTransfer">
            <div class="row">
                <div class="col-md-2">
                    <p>Event</p>
                </div>
                <div class="col-md-10">
                    <input class="form-control none-border" name="event" #event="ngModel" [(ngModel)]="vm.event" />
                </div>
            </div>
            <hr>
        </div> -->
            </div>
            <!-- <div class="form-group" *ngIf="isExpense">
        <div class="row">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" [(ngModel)]="isCheck">
                <label class="form-check-label" for="defaultCheck1">Borrow to pay</label>
            </div>
        </div>
    </div>
    <div id="lender" *ngIf="isCheck && isExpense">
        <div class="row">
            <div class="col-md-2">
                <p>Lender</p>
            </div>
            <div class="col-md-10">
                <input class="form-control none-border" name="lender" #lender="ngModel" [(ngModel)]="vm.lender" />
            </div>
        </div>
        <hr>
    </div> -->
            <button class="btn btn-success btnSave" type="submit">Save</button>
        </form>
    </div>
</section>

<!-- Modal -->
<div bsModal #categoryModal='bs-modal' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
    <div class='modal-dialog modal-lg' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                Choose Category
                <button type='button' class='text-right' (click)='categoryModal.hide()' aria-label='Close'>
                        <i class='fa fa-window-close'></i>
                    </button>
            </div>
            <div class='modal-body height-modal'>
                <input #keyword='ngModel' ngModel type='text' class='form-control' placeholder='Search..' (keyup)='search(keyword.value)'>
                <div *ngFor="let i of lstParentTmp" class="card">
                    <div class="card-header row row-margin pointer" id="headingOne">
                        <div class="col-md-11" (click)="chooseCategory(i.id, i.text, i.icon)">
                            <img src="{{apiURL + i.icon}}" style="margin-right: 2%">
                            <span>{{ i.text }}</span>
                        </div>
                        <div class="col-md-1 format-iconUp" data-toggle="collapse" (click)="changeIcon(i.id)" attr.data-target="#collapseOne{{i.id}}" aria-expanded="true" aria-controls="collapseOne">
                            <i id="arrow{{i.id}}" class="pull-right fa fa-chevron-up"></i>
                        </div>
                    </div>
                    <div attr.id="collapseOne{{i.id}}" class="panel-collapse collapse">
                        <ul *ngFor='let i2 of lstChildTmp' class="list-group pointer">
                            <li *ngIf="i2.parentId === i.id" class="list-group-item padding-left" (click)="chooseCategory(i2.id, i2.text, i2.icon)">
                                <img src="{{apiURL + i2.icon}}" class="padding-right" /> {{i2.text}}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class='modal-footer'></div>
        </div>
    </div>
</div>

<!-- Modal -->
<div bsModal #accountModal='bs-modal' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
    <div class='modal-dialog modal-lg' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                Choose Account
                <button type='button' class='text-right' (click)='accountModal.hide()' aria-label='Close'>
                        <i class='fa fa-window-close'></i>
                    </button>
            </div>
            <div class='modal-body height-modal'>
                <input #keyword='ngModel' ngModel type='text' class='form-control' placeholder='Search..' (keyup)='search(keyword.value)'>
                <div *ngFor="let i of account" class="card">
                    <div class="card-header row row-margin pointer" id="headingOne">
                        <div class="col-md-11" (click)="chooseAccount(i.accountId, i.text)">
                            <span>
                                <div class="left"> {{ i.text }}</div>
                                <div class="right"> Balance: {{ i.balance }} Vnd</div>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div bsModal #toAccountModal='bs-modal' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
    <div class='modal-dialog modal-lg' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                Choose To Account
                <button type='button' class='text-right' (click)='toAccountModal.hide()' aria-label='Close'>
                            <i class='fa fa-window-close'></i>
                        </button>
            </div>
            <div class='modal-body height-modal'>
                <input #keyword='ngModel' ngModel type='text' class='form-control' placeholder='Search..' (keyup)='search(keyword.value)'>
                <div *ngFor="let i of account" class="card">
                    <div class="card-header row row-margin pointer" id="headingOne">
                        <div class="col-md-11" (click)="chooseToAccount(i.accountId, i.text)">
                            <span>
                                    <div class="left"> {{ i.text }}</div>
                                    <div class="right"> Balance: {{ i.balance }} Vnd</div>
                                </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div bsModal #confirmModal="bs-modal" class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Notification</h5>
                <button type="button" class="close" (click)="confirmModal.hide()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
            </div>
            <div class="modal-body">
                Save successfully!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="confirmModal.hide()">Close</button>
            </div>
        </div>
    </div>
</div>